schema: '2.0'
stages:
  fit_siam_diff:
    cmd: python -m alceo fit --config config/siam-diff.yaml
    deps:
    - path: config/siam-diff.yaml
      md5: f89bb5ef3f44dbee442c0c3296dfb0e6
      size: 1576
    - path: dataset/pits/test_ASWAN
      md5: c57f5aaee452cee008c138234ad35f88.dir
      size: 112141290
      nfiles: 338
    - path: dataset/pits/test_DURA_EUROPOS
      md5: ea83752a959a2fbebdeb805c1fb07c81.dir
      size: 579536734
      nfiles: 1738
    - path: dataset/pits/test_EBLA
      md5: 079dc0ec0d43dad549ef558705d2821d.dir
      size: 348687653
      nfiles: 758
    - path: dataset/pits/train_ASWAN
      md5: 2440272c894a31d6d639d4a7c303e60b.dir
      size: 1103100904
      nfiles: 3350
    - path: dataset/pits/train_DURA_EUROPOS
      md5: 3f992623c0c90dce0136e3ca2f66be57.dir
      size: 1736840033
      nfiles: 5222
    - path: dataset/pits/train_EBLA
      md5: ef1f32df86e98ab574aaa15b9c856271.dir
      size: 1243408218
      nfiles: 2702
    - path: src
      md5: a964e19bf40a1ca02247ffef24d50e6e.dir
      size: 153020
      nfiles: 50
    params:
      config/siam-diff.yaml:
        data:
          class_path: alceo.data_module.AlceoChangeDetectionDataModule
          init_args:
            batch_size: 24
            train_paths:
            - dataset/pits/train_DURA_EUROPOS
            - dataset/pits/train_ASWAN
            - dataset/pits/train_EBLA
            validation_paths:
            - dataset/pits/test_DURA_EUROPOS
            - dataset/pits/test_ASWAN
            - dataset/pits/test_EBLA
            validation_labels:
            - DURA_EUROPOS
            - ASWAN
            - EBLA
        lr_scheduler:
          class_path: pytorch_lightning.cli.ReduceLROnPlateau
          init_args:
            mode: max
            monitor: validation/appeared/IoU
            factor: 0.95
        model:
          class_path: alceo.model.AlceoChangeDetectionModule
          init_args:
            network:
              class_path: alceo.model.SiamUnet_diff
              init_args:
                input_nbr: 4
                label_nbr: 2
            loss_fn:
              class_path: segmentation_models_pytorch.losses.JaccardLoss
              init_args:
                mode: multilabel
        optimizer:
          class_path: torch.optim.Adam
          init_args:
            lr: 0.0001
            weight_decay: 0.0001
    outs:
    - path: logs/siam_diff/DvcLiveLogger/run/checkpoints/best_IoU.ckpt
      md5: fbeb65e004e386ed3ed94d7951b09991
      size: 16340765
    - path: logs/siam_diff/metrics.json
      md5: b6d6a92ca78d243cb17c7ae1ef5dcb15
      size: 3850
    - path: logs/siam_diff/plots
      md5: a8e0b8e1c3a7f2a8150391b3ab1ff5d0.dir
      size: 27444
      nfiles: 70
